\hypertarget{server_8h_source}{}\doxysection{server.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Prepared\ for\ BCIT\ ELEX4618,\ April\ 2022,\ by\ Craig\ Hennessey}}
\DoxyCodeLine{00004\ \textcolor{comment}{}\textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ WIN4618}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\#define\ PI4618}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifdef\ PI4618}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <opencv2/opencv.hpp>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_c_server}{CServer}}}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordtype}{bool}\ \_server\_exit;}
\DoxyCodeLine{00022\ \ \ cv::Mat\ \_txim;}
\DoxyCodeLine{00023\ \ \ }
\DoxyCodeLine{00024\ \ \ std::mutex\ \_image\_mutex;}
\DoxyCodeLine{00025\ \ \ std::mutex\ \_rx\_mutex;}
\DoxyCodeLine{00026\ \ \ std::mutex\ \_tx\_mutex;}
\DoxyCodeLine{00027\ \ \ std::vector<std::string>\ \_cmd\_list;}
\DoxyCodeLine{00028\ \ \ std::vector<std::string>\ \_send\_list;}
\DoxyCodeLine{00029\ \ \ }
\DoxyCodeLine{00030\ \ \ \textcolor{keywordtype}{bool}\ setblocking(\textcolor{keywordtype}{int}\ fd,\ \textcolor{keywordtype}{bool}\ blocking);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{class_c_server}{CServer}}();}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{class_c_server}{\string~CServer}}();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ Start\ server\ listening\ (probably\ best\ to\ do\ in\ a\ separate\ thread)}}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordtype}{void}\ start(\textcolor{keywordtype}{int}\ port);}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordtype}{void}\ stop();}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ Set\ the\ image\ to\ transmit}}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordtype}{void}\ set\_txim\ (cv::Mat\ \&im);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//\ Get\ a\ vector\ of\ the\ commands\ the\ server\ has\ read}}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordtype}{void}\ get\_cmd\ (std::vector<std::string>\ \&cmds);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ Send\ a\ response}}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordtype}{void}\ send\_string\ (std::string\ send\_str);}
\DoxyCodeLine{00048\ \};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{/*}}
\DoxyCodeLine{00052\ \textcolor{comment}{NOTE:\ If\ you\ see\ this\ error\ when\ running\ your\ program\ on\ the\ Pi\ then\ follow\ the\ instructions\ below.}}
\DoxyCodeLine{00053\ \textcolor{comment}{}}
\DoxyCodeLine{00054\ \textcolor{comment}{Xlib:\ sequence\ lost(0x10061\ >\ 0x6d)\ in\ reply\ type\ 0x1c!}}
\DoxyCodeLine{00055\ \textcolor{comment}{[xcb]\ Unknown\ request\ in\ queue\ while\ dequeuing}}
\DoxyCodeLine{00056\ \textcolor{comment}{[xcb]\ Most\ likely\ this\ is\ a\ multi\ -\/\ threaded\ client\ and\ XInitThreads\ has\ not\ been\ called}}
\DoxyCodeLine{00057\ \textcolor{comment}{[xcb]\ Aborting,\ sorry\ about\ that.}}
\DoxyCodeLine{00058\ \textcolor{comment}{main\ :\ ..\ /\ ..\ /\ src\ /\ xcb\_io.c\ :\ 165\ :\ dequeue\_pending\_request\ :\ Assertion\ `!xcb\_xlib\_unknown\_req\_in\_deq'\ failed.}}
\DoxyCodeLine{00059\ \textcolor{comment}{2021\ -\/\ 03\ -\/\ 31\ 16:31\ :\ 31\ sigHandler\ :\ Unhandled\ signal\ 6,\ terminating}}
\DoxyCodeLine{00060\ \textcolor{comment}{}}
\DoxyCodeLine{00061\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00062\ \textcolor{comment}{}}
\DoxyCodeLine{00063\ \textcolor{comment}{Install\ X11\ with\ :}}
\DoxyCodeLine{00064\ \textcolor{comment}{}}
\DoxyCodeLine{00065\ \textcolor{comment}{sudo\ apt-\/get\ install\ libx11-\/dev}}
\DoxyCodeLine{00066\ \textcolor{comment}{}}
\DoxyCodeLine{00067\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00068\ \textcolor{comment}{}}
\DoxyCodeLine{00069\ \textcolor{comment}{Include\ X11\ library\ AFTER\ the\ OpenCV\ header:}}
\DoxyCodeLine{00070\ \textcolor{comment}{}}
\DoxyCodeLine{00071\ \textcolor{comment}{\#include\ <opencv2/opencv.hpp>}}
\DoxyCodeLine{00072\ \textcolor{comment}{\#include\ <X11/Xlib.h>}}
\DoxyCodeLine{00073\ \textcolor{comment}{}}
\DoxyCodeLine{00074\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00075\ \textcolor{comment}{}}
\DoxyCodeLine{00076\ \textcolor{comment}{Call\ XInitThreads\ in\ main\ or\ constructor:}}
\DoxyCodeLine{00077\ \textcolor{comment}{}}
\DoxyCodeLine{00078\ \textcolor{comment}{XInitThreads();}}
\DoxyCodeLine{00079\ \textcolor{comment}{}}
\DoxyCodeLine{00080\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00081\ \textcolor{comment}{}}
\DoxyCodeLine{00082\ \textcolor{comment}{Add\ directive\ to\ linker:}}
\DoxyCodeLine{00083\ \textcolor{comment}{-\/\ lX11}}
\DoxyCodeLine{00084\ \textcolor{comment}{}}
\DoxyCodeLine{00085\ \textcolor{comment}{*/}}

\end{DoxyCode}
